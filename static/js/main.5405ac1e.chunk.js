(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{115:function(t,e,n){},141:function(t,e,n){},153:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),a=n(27),o=n.n(a),s=(n(115),n(13)),u=n(34),i=n(15),l=n(102),d=n(2),b=function(){var t=Object(s.g)(),e=Object(s.h)();return Object(d.jsx)(l.a,{component:"h1",sx:{flexGrow:1,color:"primary.contrastText",cursor:"pointer"},onClick:function(){var n,c;t.push(null!==(n=null===e||void 0===e||null===(c=e.state)||void 0===c?void 0:c.from)&&void 0!==n?n:"/")},children:"Phonebook"})},j=n(46),f=function(){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(j.b,{to:"/login",children:Object(d.jsx)(l.a,{component:"span",color:"primary.contrastText",sx:{mr:2},children:"Login"})}),Object(d.jsx)(j.b,{to:"/register",children:Object(d.jsx)(l.a,{component:"span",color:"primary.contrastText",children:"Registration"})})]})},h=n(83),O=n(194),p=n(32),g=n(36),m=function(){var t=Object(i.d)(p.a.getUserName),e=Object(i.c)();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)(l.a,{sx:{color:"primary.contrastText",mr:1},children:["Welcome ",t,"!"]}),Object(d.jsx)(O.a,{type:"submit",variant:"contained",onClick:function(t){t.preventDefault(),e(g.a.logout())},children:"Exit"})]})},x=n(200),v=n(197),C=function(){var t=Object(i.d)(p.a.getIsLoggedIn);return Object(d.jsx)(x.a,{position:"static",children:Object(d.jsxs)(v.a,{children:[Object(d.jsx)(b,{}),t?Object(d.jsxs)(d.Fragment,{children:[" ",Object(d.jsx)(h.a,{}),Object(d.jsx)(m,{})," "]}):Object(d.jsx)(f,{})]})})},y=(n(140),n(141),function(t){var e=t.contacts,n=e.filter,c=e.entities;return""===n?c:c.filter((function(t){return t.name.toLowerCase().includes(n.toLowerCase())}))}),k=function(t){return t.contacts.entities},w=n(14),S=n(28),I=n.n(S),L=n(47),T=n(63),E=n.n(T),R=n(29),q=n.n(R),F=n(17),z={fetchContactRequest:Object(F.b)("contacts/fetchContactRequest"),fetchContactSuccess:Object(F.b)("contacts/fetchContactSuccess"),fetchContactError:Object(F.b)("contacts/fetchContactError"),addContactRequest:Object(F.b)("contacts/addContactRequest"),addContactSuccess:Object(F.b)("contacts/addContactSuccess"),addContactError:Object(F.b)("contacts/addContactError"),deleteContactRequest:Object(F.b)("contacts/deleteContactRequest"),deleteContactSuccess:Object(F.b)("contacts/deleteContactSuccess"),deleteContactError:Object(F.b)("contacts/deleteContactError"),changeFilter:Object(F.b)("contacts/changeFilter")},A=function(){return function(){var t=Object(L.a)(I.a.mark((function t(e){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(z.fetchContactRequest()),q.a.get("/contacts").then((function(t){var n=t.data;return e(z.fetchContactSuccess(n))})).catch((function(t){return u.b.error("Contact is not added! Something wrong!"),e(z.fetchContactError(t.message))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},N=n(198),B=n(189);var D=Object(i.b)(null,(function(t){return{onSubmit:function(e){var n=e.stateName,c=e.number;return t(function(t){var e=t.stateName,n=t.number;return function(t){var c={id:E.a.generate(),name:e,number:n};t(z.addContactRequest()),q.a.post("/contacts",c).then((function(e){var n=e.data;return u.b.success("Contact successfully added!"),t(z.addContactSuccess(n))})).catch((function(e){return u.b.error("Contact is not added! Something wrong!"),t(z.addContactError(e.message))}))}}({stateName:n,number:c}))}}}))((function(t){var e=t.onSubmit,n=Object(c.useState)(""),r=Object(w.a)(n,2),a=r[0],o=r[1],s=Object(c.useState)(""),l=Object(w.a)(s,2),b=l[0],j=l[1],f=Object(i.d)(k),h=function(){o(""),j("")},p=function(t){var e=t.target,n=e.name,c=e.value;0!==n&&("name"===n?o(c):"number"===n&&j(c))};return Object(d.jsx)(N.a,{children:Object(d.jsxs)("form",{onSubmit:function(t){t.preventDefault(),f.find((function(t){return t.name===a||t.number===b}))?u.b.warning("Contact already exists!"):e({stateName:a,number:b}),h()},children:[Object(d.jsx)(B.a,{label:"Name",type:"text",name:"name",pattern:"^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$",title:"\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0431\u0443\u043a\u0432, \u0430\u043f\u043e\u0441\u0442\u0440\u043e\u0444\u0430, \u0442\u0438\u0440\u0435 \u0438 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u0432. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan \u0438 \u0442. \u043f.",required:!0,value:a,onChange:p,variant:"standard",sx:{width:1}}),Object(d.jsx)(B.a,{label:"Number",type:"tel",name:"number",pattern:"\\+?\\d{1,4}?[-.\\s]?\\(?\\d{1,3}?\\)?[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,9}",title:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0446\u0438\u0444\u0440 \u0438 \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b, \u0442\u0438\u0440\u0435, \u043a\u0440\u0443\u0433\u043b\u044b\u0435 \u0441\u043a\u043e\u0431\u043a\u0438 \u0438 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0441 +",required:!0,value:b,onChange:p,variant:"standard",sx:{width:1}}),Object(d.jsx)(O.a,{type:"submit",onSubmit:h,variant:"contained",sx:{mt:4},children:"Add contact"})]})})})),M=Object(i.b)((function(t){return{value:t.contacts.filter}}),(function(t){return{onChange:function(e){return t(z.changeFilter(e.target.value))}}}))((function(t){var e=t.value,n=t.onChange;return Object(d.jsx)(B.a,{label:"Find contacts by name",type:"text",name:"filter",value:e,onChange:n,variant:"standard",sx:{mt:2,width:1}})})),U=n(199),J=n(191);var P=Object(i.b)((function(t){return{value:t.contacts.entities}}),(function(t){return{onDelete:function(e){return t((n=e,function(t){t(z.deleteContactRequest()),q.a.delete("/contacts/".concat(n)).then((function(){return u.b.success("Contact successfully deleted!"),t(z.deleteContactSuccess(n))})).catch((function(e){return u.b.error("Contact is not deleted! Something wrong!"),t(z.deleteContactError(e))}))}));var n}}}))((function(t){var e=t.onDelete,n=Object(i.d)(y),r=Object(i.c)();return Object(c.useEffect)((function(){r(A())}),[r]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(l.a,{component:"h2",sx:{fontSize:24,textAlign:"center",mb:2,mt:2},children:"Contacts"}),Object(d.jsx)(U.a,{children:n.map((function(t){var n=t.name,c=t.number,r=t.id;return Object(d.jsxs)(J.a,{sx:{justifyContent:"space-between",width:320},children:[n,":",Object(d.jsx)(l.a,{component:"span",sx:{mr:1},children:c}),Object(d.jsx)(O.a,{type:"button",onClick:function(){return e(r)},color:"secondary",variant:"contained",children:"Delete"})]},E.a.generate())}))})]})})),Z=n(196),W=function(){var t=Object(i.d)(k),e=Object(i.c)();return Object(c.useEffect)((function(){e(A())}),[]),Object(d.jsxs)(Z.a,{sx:{mt:4,display:"flex",flexDirection:"column",alignItems:"center",width:350},children:[0===t.length&&Object(d.jsx)(l.a,{component:"h3",sx:{mt:2,mb:2},children:"There are no contacts here yet, let's add?"}),Object(d.jsx)(D,{}),0!==t.length&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(M,{}),Object(d.jsx)(P,{})]})]})},G=n(44),H=n(65),V=["children","redirectTo"],$=function(t){var e=t.children,n=t.redirectTo,c=void 0===n?"/":n,r=Object(H.a)(t,V),a=Object(i.d)(p.a.getIsLoggedIn);return Object(d.jsx)(s.b,Object(G.a)(Object(G.a)({},r),{},{children:a?e:Object(d.jsx)(s.a,{to:c})}))},K=["children","redirectTo","restricted"],Q=function(t){var e=t.children,n=t.redirectTo,c=void 0===n?"/":n,r=t.restricted,a=void 0!==r&&r,o=Object(H.a)(t,K),u=Object(i.d)(p.a.getIsLoggedIn)&&a;return Object(d.jsx)(s.b,Object(G.a)(Object(G.a)({},o),{},{children:u?Object(d.jsx)(s.a,{to:c}):e}))},X=Object(c.lazy)((function(){return n.e(3).then(n.bind(null,203))})),Y=Object(c.lazy)((function(){return n.e(4).then(n.bind(null,201))})),_=Object(c.lazy)((function(){return n.e(5).then(n.bind(null,202))}));var tt,et,nt,ct,rt=function(){var t=Object(i.c)(),e=Object(i.d)(k);return console.log(0===e.length),Object(c.useEffect)((function(){t(g.a.fetchCurrentUser())}),[t]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(C,{}),Object(d.jsx)(c.Suspense,{fallback:Object(d.jsx)("div",{children:"Loading..."}),children:Object(d.jsxs)(s.d,{children:[Object(d.jsx)(Q,{exact:!0,path:"/",children:Object(d.jsx)(X,{})}),Object(d.jsx)(Q,{path:"/login",redirectTo:"/contacts",restricted:!0,children:Object(d.jsx)(Y,{})}),Object(d.jsx)(Q,{path:"/register",restricted:!0,children:Object(d.jsx)(_,{})}),Object(d.jsx)($,{path:"/contacts",redirectTo:"/login",children:Object(d.jsx)(W,{})}),Object(d.jsx)(s.a,{to:"/"})]})}),Object(d.jsx)(u.a,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})},at=n(18),ot=n(39),st=n(96),ut=n.n(st),it=n(97),lt=n.n(it),dt=n(4),bt=n(22),jt=Object(F.d)([],(tt={},Object(dt.a)(tt,z.fetchContactSuccess,(function(t,e){return e.payload})),Object(dt.a)(tt,z.addContactSuccess,(function(t,e){var n=e.payload;return t.find((function(t){return t.name===n.name||t.number===n.number}))?t:[].concat(Object(at.a)(t),[n])})),Object(dt.a)(tt,z.deleteContactSuccess,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),tt)),ft=Object(F.d)("",Object(dt.a)({},z.changeFilter,(function(t,e){return e.payload}))),ht=Object(F.d)(!1,(et={},Object(dt.a)(et,z.fetchContactRequest,(function(){return!0})),Object(dt.a)(et,z.fetchContactSuccess,(function(){return!1})),Object(dt.a)(et,z.fetchContactError,(function(){return!1})),et)),Ot=Object(F.d)(null,(nt={},Object(dt.a)(nt,z.fetchContactRequest,(function(t,e){return e.payload})),Object(dt.a)(nt,z.fetchContactRequest,(function(){return null})),nt)),pt=Object(bt.b)({filter:ft,entities:jt,isLoading:ht,error:Ot}),gt=Object(F.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1},extraReducers:(ct={},Object(dt.a)(ct,g.a.register.fulfilled,(function(t,e){var n=e.payload;t.user=n.user,t.token=n.token,t.isLoggedIn=!0})),Object(dt.a)(ct,g.a.login.fulfilled,(function(t,e){var n=e.payload;t.user=n.user,t.token=n.token,t.isLoggedIn=!0})),Object(dt.a)(ct,g.a.logout.fulfilled,(function(t){t.user={name:null,email:null},t.token=null,t.isLoggedIn=!1})),Object(dt.a)(ct,g.a.fetchCurrentUser.fulfilled,(function(t,e){var n=e.payload;t.user=Object(G.a)({},n),t.isLoggedIn=!0})),ct)}).reducer,mt={key:"auth",storage:lt.a,whitelist:["token"]},xt=Object(F.a)({reducer:{auth:Object(ot.g)(mt,gt),contacts:pt},middleware:function(t){return[].concat(Object(at.a)(t({serializableCheck:{ignoredActions:[ot.a,ot.f,ot.b,ot.c,ot.d,ot.e]}})),[ut.a])},devTools:!1}),vt=Object(ot.h)(xt),Ct=n(98),yt=n(193),kt=n(99),wt=Object(kt.a)({palette:{type:"light",primary:{light:"#1769aa",main:"#2196f3",dark:"#4dabf5",contrastText:"#fff"},secondary:{light:"#ab003c",main:"#f50057",dark:"#f73378",contrastText:"#000"}}}),St=Object(kt.a)(wt,{components:{MuiAppBar:{styleOverrides:{root:{color:wt.palette.primary.contrastText}}},MuiTypography:{styleOverrides:{root:{color:wt.palette.primary.light}}},MuiButton:{styleOverrides:{root:{color:wt.palette.primary.contrastText}}}}});o.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(yt.a,{theme:St,children:Object(d.jsx)(i.a,{store:xt,children:Object(d.jsx)(Ct.a,{loading:null,persistor:vt,children:Object(d.jsx)(j.a,{children:Object(d.jsx)(rt,{})})})})})}),document.getElementById("root"))},32:function(t,e,n){"use strict";var c={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUserName:function(t){return t.auth.user.name}};e.a=c},36:function(t,e,n){"use strict";var c=n(28),r=n.n(c),a=n(47),o=n(17),s=n(29),u=n.n(s);u.a.defaults.baseURL="https://connections-api.herokuapp.com";var i=function(t){u.a.defaults.headers.common.Authorization="Bearer ".concat(t)},l=function(){u.a.defaults.headers.common.Authorization=""},d=Object(o.c)("auth/register",function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.post("/users/signup",e);case 3:return n=t.sent,c=n.data,i(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),b=Object(o.c)("auth/login",function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.post("/users/login",e);case 3:return n=t.sent,c=n.data,i(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),j=Object(o.c)("auth/logout",Object(a.a)(r.a.mark((function t(){var e,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.post("/users/logout");case 3:return e=t.sent,n=e.data,l(),t.abrupt("return",n);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})))),f=Object(o.c)("auth/refresh",function(){var t=Object(a.a)(r.a.mark((function t(e,n){var c,a,o,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=n.getState(),null!==(a=c.auth.token)){t.next=5;break}return console.log("Exit"),t.abrupt("return",n.rejectWithValue(5));case 5:return i(a),t.prev=6,t.next=9,u.a.get("/users/current");case 9:return o=t.sent,s=o.data,t.abrupt("return",s);case 14:t.prev=14,t.t0=t.catch(6);case 16:case"end":return t.stop()}}),t,null,[[6,14]])})));return function(e,n){return t.apply(this,arguments)}}());e.a={register:d,login:b,logout:j,fetchCurrentUser:f}},83:function(t,e,n){"use strict";var c=n(102),r=n(15),a=n(46),o=n(32),s=n(2);e.a=function(){var t=Object(r.d)(o.a.getIsLoggedIn);return Object(s.jsx)(a.b,{to:"/contacts",children:t?Object(s.jsxs)(c.a,{component:"span",color:"#fff",sx:{mr:8},children:[" ","My contacts"]}):Object(s.jsx)(c.a,{children:" Open your Phonebook"})})}}},[[153,1,2]]]);
//# sourceMappingURL=main.5405ac1e.chunk.js.map